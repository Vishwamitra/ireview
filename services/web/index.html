<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Review App - Products</title>
        <meta name="description" content="A website that reviews products">
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <link rel="stylesheet" href="css/all.css?v=1.0">
        <link rel="stylesheet" href="css/products.css?v=1.0">
        <script src="js/all.js"></script>
    </head>
    <body>
        <div id="page_products">
            <div class="loader"></div>
        </div>
        <script>

            /* -----------------------      
            ------- Show contents --------
            -------------------------- */

            const insertProducts = (products) => {
                const productWrapper = document.querySelector("#page_products")
                productWrapper.innerHTML = ""

                products.forEach((product, i) => {
                    productWrapper.innerHTML += `<a class='product' href="product.html?id=${product.ProductID}">
                        <div class='product-image' style='background-image: url(images/product-cover-${product.ProductID}.png);'> </div>
                        <h3 class='title'> ${product.ProductName} </h3>
                        <div class='stars'> ${starsHtml(product.AvgReview)} </div>
                        <h4 class='summary'> ${product.ProductSummary} </h4>
                        <h5> $${product.ProductPrice} </h5>
                    </a>`
                })
            }

            /* -----------------------      
            ------- API --------
            -------------------------- */

            const fetchProducts = () => { 
                axios.get('http://localhost:5000/products').then(response => {
                    insertProducts(response.data)
                }).catch(error => console.error(error))
            }

            /* -----------------------      
            ------- On render --------
            -------------------------- */

            window.onload = () => {
                fetchProducts()
            }
        </script>
    </body>
</html>